# Java基础-原码, 反码, 补码

## 机器数

所有数字在计算机底层都是以二进制形式存在的.它的表现形式叫做机器数,这个数有正负之分,最高位为符号位.0 表示正数, 1 表示负数.

> 例如正数 5 在计算机用以一个 8 位(计算机最小储存单位)表示 `0000 0101`, 而 -5 则用 `1000 0101`表示.

## 真值

计算机中的机器数对应的真实的值就是真数,对最高位(符号位)后面的二进制数转换成十进制,并根据最高位判断正负.

> 例如上面的数 `0000 0101` 转换成十进制真值为 5 
> `1000 0101` 去除第一位符号位 `1` 后面的二进制转换为十进制为 5 加上第一位符号位 `-` 所以值为 `-5`

## 原码

原码就是符号位加上真值的绝对值,即用第一位表示符号, 其余位表示值. 比如如果是8位二进制:

`+1 = 0000 0001`
`-1 = 1000 0001`
第一位是符号位,所以 8 位二进制数的取值范围为`[1111 1111 , 0111 1111]`
即 `[-127 , 127]`

## 反码

* 正数的反码是其本身.
* 负数的反码是在其原码的基础上,符号位不变,其余各位取反.

|      | 原码        | 反码        |
| ---- | ----------- | ----------- |
| `+1` | `0000 0001` | `0000 0001` |
| `-1` | `1000 0001` | `1111 1110` |

## 补码

* 正数的补码是其本身
* 负数的补码是在其反码的基础上加 1

|   |原码|反码|补码|
|---| --- | --- | --- |
|`+1`|`0000 0001`| `0000 0001`| `0000 0001`
|`-1`|`1000 0001`| `1111 1110`| `1111 1111`


## 为什么使用原码、 反码、 补码

原码第一位是符号位,在计算过程中我们会自动根据符号位对真值区域的内容加减.但是对于计算机,加减乘除是最基础的运算.需要设计的尽量简单.计算机辨别符号位显然会让计算机的基础电路设计变的十分复杂.于是人们想出了将符号位也参与运算的方法. 我们知道, 根据运算法则减去一个正数等于加上一个负数, 即: `1-1 = 1 + (-1) = 0 `, 所以机器可以只有加法而没有减法, 这样计算机运算的设计就更简单了.
如果将符号位参与计算:

```
原码
1 - 1 = 1 + (-1) = 0000 0001 + 1000 0001 = 1000 0010 = -2
```

如果用原码表示, 让符号位也参与计算, 显然对于减法来说, 结果是不正确的.这也就是为何计算机内部不使用原码表示一个数.
为了解决上述问题出现了反码:

```
1 -1 = 1 + (-1) = 0000 0001(原) + 1000 0001(原) = 0000 0001(反) + 1111 1110(反) = 1111 1111(反) = 1000 0000(原) = -0
```

用反码计算发现真值部分计算是正确的,而唯一的问题其实就出现在 `-0` 上,虽然人们理解上+0和-0是一样的, 但是0带符号是没有任何意义的. 而且会有`0000 0000`和`1000 0000`两个编码表示0.

于是补码的出现, 解决了0的符号以及两个编码的问题:

```
1 -1 = 1 + (-1) = 0000 0001(原) + 1000 0001(原) = 0000 0001(反) + 1111 1110(反) = 0000 0001(补) + 1111 1111(补) = (1)0000 0000(补) = 0000 0000(原) = 0
```

这样0用`0000 0000`表示, 而以前出现问题的-0则不存在了.而且可以用`1000 0000`表示`-128`.

`-1-127`的结果应该是`-128`, 在用补码运算的结果中, `1000 0000(补)` 就是`-128`. 但是注意因为实际上是使用以前的`-0`的补码来表示`-128`, 所以`-128`并没有原码和反码表示.对`-128`的补码表示`1000 0000`补算出来的原码是`0000 0000`原, 这是不正确的)

使用补码, 不仅仅修复了0的符号以及存在两个编码的问题, 而且还能够多表示一个最低数. 这就是为什么8位二进制, 使用原码或反码表示的范围为`[-127, +127]`, 而使用补码表示的范围为`[-128, 127]`.

因为机器使用补码, 所以对于编程中常用到的32位int类型, 可以表示范围是: `[-2^31, 2^31-1]` 因为第一位表示的是符号位.而使用补码表示时又可以多保存一个最小值.